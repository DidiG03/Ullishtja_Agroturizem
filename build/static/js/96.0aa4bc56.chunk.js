"use strict";(self.webpackChunkullishtja_agroturizem=self.webpackChunkullishtja_agroturizem||[]).push([[96],{2096:(e,s,a)=>{a.r(s),a.d(s,{default:()=>n});var r=a(5043),i=a(5275),t=a(1045),l=a(579);const n=()=>{const{isSignedIn:e,user:s}=(0,i.Jd)(),{signIn:a,setActive:n}=(0,i.go)(),[d,o]=(0,r.useState)(""),[c,m]=(0,r.useState)(""),[u,h]=(0,r.useState)(!1),[g,p]=(0,r.useState)(""),[j,x]=(0,r.useState)(!1),[v,y]=(0,r.useState)(!1),[f,b]=(0,r.useState)(""),[w,N]=(0,r.useState)(""),[S,F]=(0,r.useState)(""),[C,P]=(0,r.useState)("request");if(e&&s){var _;if(((null===(_="user_xxxxx,user_yyyyy")?void 0:_.split(","))||[]).includes(s.id))return(0,l.jsx)(t.C5,{to:"/dashboard",replace:!0})}const k=async e=>{e.preventDefault(),h(!0),p("");try{await a.create({identifier:d});const e=a.supportedFirstFactors.find(e=>"reset_password_email_code"===e.strategy);e?(await a.prepareFirstFactor({strategy:"reset_password_email_code",emailAddressId:e.emailAddressId}),y(!0),P("verify")):p("Password reset is not available for this account.")}catch(i){var s,r;p((null===(s=i.errors)||void 0===s||null===(r=s[0])||void 0===r?void 0:r.message)||"Failed to send reset email. Please check your email address.")}finally{h(!1)}},q=async e=>{e.preventDefault(),h(!0),p("");try{"needs_new_password"===(await a.attemptFirstFactor({strategy:"reset_password_email_code",code:f})).status?P("reset"):p("Invalid reset code. Please try again.")}catch(i){var s,r;p((null===(s=i.errors)||void 0===s||null===(r=s[0])||void 0===r?void 0:r.message)||"Invalid reset code. Please try again.")}finally{h(!1)}},E=async e=>{if(e.preventDefault(),h(!0),p(""),w!==S)return p("Passwords do not match."),void h(!1);if(w.length<8)return p("Password must be at least 8 characters long."),void h(!1);try{const e=await a.resetPassword({password:w});"complete"===e.status?await n({session:e.createdSessionId}):p("Failed to reset password. Please try again.")}catch(i){var s,r;p((null===(s=i.errors)||void 0===s||null===(r=s[0])||void 0===r?void 0:r.message)||"Failed to reset password. Please try again.")}finally{h(!1)}},I=()=>{x(!1),y(!1),b(""),N(""),F(""),P("request"),p("")};return j?(0,l.jsx)("div",{className:"admin-login-container",children:(0,l.jsxs)("div",{className:"admin-login-content",children:[(0,l.jsxs)("div",{className:"login-header",children:[(0,l.jsx)("img",{src:"https://ucarecdn.com/f2ebac4d-52d3-45f7-997d-3e2dea09557b/ullishtja_logo.jpeg",alt:"Ullishtja Agriturizem",className:"login-logo"}),(0,l.jsx)("h1",{children:"Reset Password"}),(0,l.jsxs)("p",{children:["request"===C&&"Enter your email to receive a reset code","verify"===C&&"Enter the code sent to your email","reset"===C&&"Create your new password"]})]}),g&&(0,l.jsxs)("div",{className:"error-message",children:[(0,l.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),g]}),v&&"verify"===C&&(0,l.jsxs)("div",{className:"success-message",children:[(0,l.jsx)("span",{className:"success-icon",children:"\u2705"}),"Reset code sent to ",d,". Please check your email."]}),"request"===C&&(0,l.jsxs)("form",{onSubmit:k,className:"custom-login-form",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"reset-email",children:"Email Address"}),(0,l.jsx)("input",{type:"email",id:"reset-email",value:d,onChange:e=>o(e.target.value),placeholder:"Enter your email",required:!0,disabled:u})]}),(0,l.jsx)("button",{type:"submit",className:"login-button",disabled:u,children:u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"spinner"}),"Sending..."]}):"Send Reset Code"})]}),"verify"===C&&(0,l.jsxs)("form",{onSubmit:q,className:"custom-login-form",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"reset-code",children:"Reset Code"}),(0,l.jsx)("input",{type:"text",id:"reset-code",value:f,onChange:e=>b(e.target.value),placeholder:"Enter the 6-digit code",required:!0,disabled:u,maxLength:6})]}),(0,l.jsx)("button",{type:"submit",className:"login-button",disabled:u,children:u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"spinner"}),"Verifying..."]}):"Verify Code"})]}),"reset"===C&&(0,l.jsxs)("form",{onSubmit:E,className:"custom-login-form",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"new-password",children:"New Password"}),(0,l.jsx)("input",{type:"password",id:"new-password",value:w,onChange:e=>N(e.target.value),placeholder:"Enter new password",required:!0,disabled:u,minLength:8})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"confirm-password",children:"Confirm Password"}),(0,l.jsx)("input",{type:"password",id:"confirm-password",value:S,onChange:e=>F(e.target.value),placeholder:"Confirm new password",required:!0,disabled:u,minLength:8})]}),(0,l.jsx)("button",{type:"submit",className:"login-button",disabled:u,children:u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"spinner"}),"Resetting..."]}):"Reset Password"})]}),(0,l.jsx)("div",{className:"auth-links",children:(0,l.jsx)("button",{onClick:I,className:"link-button",disabled:u,children:"\u2190 Back to Login"})})]})}):(0,l.jsx)("div",{className:"admin-login-container",children:(0,l.jsxs)("div",{className:"admin-login-content",children:[(0,l.jsxs)("div",{className:"login-header",children:[(0,l.jsx)("img",{src:"https://ucarecdn.com/f2ebac4d-52d3-45f7-997d-3e2dea09557b/ullishtja_logo.jpeg",alt:"Ullishtja Agriturizem",className:"login-logo"}),(0,l.jsx)("h1",{children:"Admin Login"}),(0,l.jsx)("p",{children:"Sign in to access the admin dashboard"})]}),(0,l.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),h(!0),p("");try{const e=await a.create({identifier:d,password:c});"complete"===e.status?await n({session:e.createdSessionId}):p("Login failed. Please check your credentials.")}catch(i){var s,r;p((null===(s=i.errors)||void 0===s||null===(r=s[0])||void 0===r?void 0:r.message)||"Login failed. Please check your credentials.")}finally{h(!1)}},className:"custom-login-form",children:[g&&(0,l.jsxs)("div",{className:"error-message",children:[(0,l.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),g]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,l.jsx)("input",{type:"email",id:"email",value:d,onChange:e=>o(e.target.value),placeholder:"Enter your email",required:!0,disabled:u})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"password",children:"Password"}),(0,l.jsx)("input",{type:"password",id:"password",value:c,onChange:e=>m(e.target.value),placeholder:"Enter your password",required:!0,disabled:u})]}),(0,l.jsx)("button",{type:"submit",className:"login-button",disabled:u,children:u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"spinner"}),"Signing in..."]}):"Sign In"})]}),(0,l.jsx)("div",{className:"auth-links",children:(0,l.jsx)("button",{onClick:()=>x(!0),className:"link-button",disabled:u,children:"Forgot your password?"})})]})})}}}]);
//# sourceMappingURL=96.0aa4bc56.chunk.js.map